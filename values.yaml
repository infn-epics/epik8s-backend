# Global Configuration
# Target namespace for all backend services
namespace: backend

# Enable OpenShift specific configurations
openshift: false

# Ingress class name (use "" for OpenShift routes)
ingressClassName: "nginx"

# Base domain for ingress hosts
domain: apps.okd-datest.lnf.infn.it

# Default persistent volume size
size: 10Gi

# Elasticsearch Configuration
elasticsearch:
  # Official Elastic Helm chart version (https://github.com/elastic/helm-charts)
  targetRevision: '8.5.1'
  
  # Number of Elasticsearch nodes
  replicaCount: 1
  
  # Enable Kibana dashboard
  kibanaEnabled: false
  
  # Kibana chart version (separate from Elasticsearch)
  kibanaTargetRevision: '8.5.1'
  
  # Resource limits and requests
  resources:
    limits:
      cpu: 5
      memory: 4Gi
    requests:
      cpu: 1
      memory: 2Gi
  
  # Kibana authentication credentials
  kibana:
    username: "epics"
    password: "epics"

# MongoDB Configuration
mongo:
  # Enable MongoDB deployment
  enabled: true
  
  # Number of MongoDB replicas
  replicaCount: 1
  
  # Bitnami MongoDB chart version (not used with direct deployment)
  targetRevision: '14.12.3'
  
  # Authentication settings
  auth:
    enabled: false
    # Uncomment and set if auth is enabled
    # rootUser: "root"
    # rootPassword: "changeme"
    # database: "olog"
  
  # Resource limits and requests
  resources:
    limits:
      cpu: 2
      memory: 2Gi
    requests:
      cpu: 1
      memory: 1Gi

# Kafka Configuration (using Strimzi Operator)
kafka:
  # Enable Kafka deployment
  enabled: true
  
  # Kafka cluster name
  clusterName: "epics-kafka"
  
  # Kafka version (Strimzi 0.48.0 supports 4.0.0 and 4.1.0)
  version: "4.1.0"
  
  # Number of Kafka broker replicas
  replicaCount: 3
  
  # Strimzi Operator configuration
  strimzi:
    # Strimzi operator Helm chart version
    operatorVersion: "0.48.0"
    
    # Git repository for Kafka CR manifests
    repoURL: "https://github.com/infn-epics/epik8s-backend.git"
    targetRevision: "HEAD"
    
    # Operator resource limits
    operatorResources:
      limits:
        cpu: 1000m
        memory: 384Mi
      requests:
        cpu: 200m
        memory: 384Mi
  
  # Kafka broker storage
  storage:
    type: persistent-claim
    size: 10Gi
    deleteClaim: false
    # storageClass: ""  # Uncomment to specify storage class
  
  # Kafka broker resources
  resources:
    limits:
      cpu: 2
      memory: 4Gi
    requests:
      cpu: 1
      memory: 2Gi
  
  # External access configuration
  externalAccess:
    enabled: false
    type: loadbalancer
    port: 9094
    # Bootstrap LoadBalancer IP
    bootstrap:
      loadBalancerIP: 10.10.6.250
    # Per-broker LoadBalancer IPs
    brokers:
      - broker: 0
        loadBalancerIP: 10.10.6.250
      - broker: 1
        loadBalancerIP: 10.10.6.251
      - broker: 2
        loadBalancerIP: 10.10.6.252
  
  # Additional Kafka configuration
  config: {}
    # log.retention.hours: 168
    # log.segment.bytes: 1073741824
  
  # Zookeeper configuration
  zookeeper:
    replicaCount: 3
    storage:
      type: persistent-claim
      size: 5Gi
      deleteClaim: false
      # storageClass: ""
    resources:
      limits:
        cpu: 1
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 1Gi
  
  # Entity Operator (Topic and User operators)
  entityOperator:
    enabled: true
    topicOperator:
      resources:
        limits:
          cpu: 500m
          memory: 512Mi
        requests:
          cpu: 200m
          memory: 512Mi
    userOperator:
      resources:
        limits:
          cpu: 500m
          memory: 512Mi
        requests:
          cpu: 200m
          memory: 512Mi